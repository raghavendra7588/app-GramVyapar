<div *ngIf="isDisplay">
  <div class="container-fluid mt-3">
    <div class="row">

      <div class="col-md-6 col-sm-6 col-12">

        <mat-form-field style="width: 100%;">
          <mat-label>Filter</mat-label>
          <input matInput (keyup)="applyFilter($event.target.value)">
        </mat-form-field>

      </div>

      <div class="col-md-3 col-sm-3 col-12">
        <button mat-raised-button color="primary" [disabled]="updateAllRecordsCount===0" class="width-100 mt-2"
          (click)="updateAll()">Update Quantity
          (<span>{{updateAllRecordsCount === 0 ? 0 : updateAllRecordsCount}}</span>) </button>
      </div>

      <div class="col-md-3 col-sm-3 col-12">
        <button mat-raised-button color="primary" class="width-100 mt-2" (click)="goToCategories()">Add New Products
        </button>
      </div>
    </div>
  </div>


  <div class="col-md-12 col-12 col-sm-12">

    <table mat-table [dataSource]="dataSource">


      <ng-container matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef style="width: 20px;">
          <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()">
          </mat-checkbox>
        </th>
        <td mat-cell *matCellDef="let row">
          <mat-checkbox (click)="$event.stopPropagation()"
            (change)="$event ? [selection.toggle(row),onChange($event)] : null" [checked]="selection.isSelected(row)">
          </mat-checkbox>
        </td>
      </ng-container>
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Product Name </th>
        <td mat-cell *matCellDef="let element">
          <h5>
            {{element.name}}
          </h5>
        </td>
      </ng-container>
      <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Units </th>
        <td mat-cell *matCellDef="let element">
          <h5>
            {{element.Unit}}
          </h5>

        </td>
      </ng-container>

      <ng-container matColumnDef="mrp">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> MRP </th>
        <td mat-cell *matCellDef="let element">
          <h5>
            {{element.MRP}}
          </h5>
        </td>
      </ng-container>

      <ng-container matColumnDef="discount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Discount</th>
        <td mat-cell *matCellDef="let element">

          <h5>
            {{element.Discount}}
          </h5>
        </td>
      </ng-container>

      <ng-container matColumnDef="finalPrice">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Final Price </th>
        <td mat-cell *matCellDef="let element; let i = index">

          <h5>
            {{element.FinalPrice}}
          </h5>

        </td>
      </ng-container>

      <ng-container matColumnDef="requiredQuantity">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Quantity </th>
        <td mat-cell *matCellDef="let element">
          <mat-form-field style="min-width:auto;max-width: 30px;">
            <input matInput placeholder="Quantity" [(ngModel)]="element.RequiredQuantity">
          </mat-form-field>

        </td>
      </ng-container>

      <ng-container matColumnDef="delete">
        <th mat-header-cell *matHeaderCellDef> Delete </th>
        <td mat-cell *matCellDef="let element">
          <button mat-icon-button (click)="openModal(template,element)">
            <mat-icon class="mat-18">delete</mat-icon>
          </button>
        </td>
      </ng-container>


      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[10, 20, 50]" showFirstLastButtons></mat-paginator>

  </div>


  <div class="container-fluid my-5">
    <div class="row">
      <div class="col-md-3 col-sm-3 col-3">
        <h4 style="text-align: left;" class="font-weight-bold">Delivery Type </h4>
        <mat-form-field style="width: 100% !important;">
          <mat-select [(ngModel)]="purchaseProducts.DeliveryType">
            <mat-option *ngFor="let item of deliveryType;" [value]="item.type"
              (click)="selectedDeliveryTypeFromList(item)">
              {{item.type}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-md-3 col-sm-3 col-3">
        <h4 style="text-align: left;" class="font-weight-bold">Payment Type </h4>
        <mat-form-field style="width: 100% !important;">
          <mat-select [(ngModel)]="purchaseProducts.PaymentType">
            <mat-option *ngFor="let item of paymentType;" [value]="item.type"
              (click)="selectedPaymentTermFromList(item)">
              {{item.type}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div class="col-md-3 col-sm-3 col-3">
        <h4 style="text-align: left;" class="font-weight-bold">Delivery Date </h4>
        <mat-form-field style="width: 100% !important;">

          <input matInput [matDatepicker]="picker1" autocomplete="off" [min]="minDate"
            [(ngModel)]="purchaseProducts.DeliveryDate" (dateInput)="addEvent('input', $event)"
            (dateChange)="addEvent('change', $event)">
          <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
          <mat-datepicker #picker1></mat-datepicker>
        </mat-form-field>
      </div>
      <div class="col-md-3 col-sm-3 col-3">
        <h4 style="text-align: left;" class="font-weight-bold">Delivery Time </h4>
        <mat-form-field style="width: 100% !important;">
          <mat-select [(ngModel)]="purchaseProducts.DeliveryTime">
            <mat-option *ngFor="let item of deliveryTime;" [value]="item.type"
              (click)="selectedDeliveryTimeFromList(item)">
              {{item.type}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>

    </div>
  </div>

  <div class="container-fluid">
    <h4 class="font-weight-bold">Please Enter Your Mobile No : </h4>
    <div class="row">
      <div class="col-md-3 col-6 col-sm-3">
        <mat-form-field style="width: 100%;">
          <input matInput placeholder="Name" [(ngModel)]="mobileNo" />
        </mat-form-field>
      </div>
      <div class="col-md-2 col-4 col-sm-4">
        <button mat-raised-button color="primary" class="mt-2 mx-auto d-block"
          (click)="openConfirmModal(templatee)">Proceed
        </button>
      </div>
    </div>
  </div>



  <div class="container-fluid my-5">
    <div class="row justify-content-center">
      <div class="col-md-9 col-sm-9 col-12">
  
        <div class="row">

          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="Name" [(ngModel)]="address.name" readonly />
            </mat-form-field>
          </div>
          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="Mobile Number" [(ngModel)]="address.mobileNumber" readonly />
            </mat-form-field>
          </div>
          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="House No" [(ngModel)]="address.houseNo" readonly />
            </mat-form-field>
          </div>
        </div>

        <div class="row">

          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="Society" [(ngModel)]="address.society" readonly />
            </mat-form-field>
          </div>
          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="Land Mark" [(ngModel)]="address.landMark" readonly />
            </mat-form-field>
          </div>
          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="Pin Code" [(ngModel)]="address.pinCode" readonly />
            </mat-form-field>
          </div>
        </div>

        <div class="row">

          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="City" [(ngModel)]="address.city" readonly />
            </mat-form-field>
          </div>
          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="Area" [(ngModel)]="address.area" readonly />
            </mat-form-field>
          </div>
          <div class="col-md-4 col-sm-4 col-12">
            <mat-form-field style="width: 100%;">
              <input matInput placeholder="State" [(ngModel)]="address.state" readonly />
            </mat-form-field>
          </div>
        </div>

      </div>
      <div class="col-md-3 col-sm-3 col-12 mt-2">
        <div class="card" style="width: 100%; height: 205px;">
          <h3 class="mt-3" style="text-align: center;color:blue;">Order Summary </h3>
  
          <p class="text-center font-weight-bold">Total Items Ordered : {{totalItemsOrdered}}</p>

          <p class="text-center font-weight-bold">Total MRP : {{totalMRP}}</p>
          <p class="text-center font-weight-bold">Total Discount : {{totalDiscount}}</p>
          <p class="text-center font-weight-bold" style="color: blue;">Total Payable Amount : {{totalPayableAmount}}</p>
        </div>
      </div>

    </div>
  </div>
  <div class="container-fluid mb-4">
    <div class="row mt-3">
      <div class="col-md-9 col-sm-9 col-12"></div>
      <div class="col-md-3 col-sm-3 col-12 width-100">
    
        <button mat-raised-button color="primary"
          [disabled]="!isAddressSelected || !isDeliveryType || !ispaymentType || !isDeliveryDate || !isDeliveryTime"
          class="width-100 mt-2" (click)="placeOrder()">Place Order
        </button>

      </div>


    </div>

  </div>
</div>

<!-- </div> -->

<h1 class="mt-5" style="text-align: center;color:blue;" *ngIf=" !isDisplay">Your Cart is Empty</h1>

<button mat-raised-button color="primary" class="mt-2 mx-auto d-block" *ngIf=" !isDisplay"
  (click)="goToCategoriesPage()">Continue Shopping
</button>
<!-- <button class="btn btn-primary mx-auto d-block" *ngIf=" !isDisplay ">My Button</button> -->

<!-- <div class="container mt-5">
    <div class="row">
      <div class="col-md-12 text-center">
        <h2  *ngIf="isDisplay===false">Your Cart is Empty</h2>
      </div>
    </div>
  </div> -->


<!-- 
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-9 col-sm-9 col-7" style="height: 500px;background-color: red;">
  
      </div>
      <div class="col-md-3 col-sm-3 col-5" style="height: 500px;background-color: blue;">
  
      </div>
    </div>
  </div> -->



<!-- <pre class="card card-block card-header">{{message}}</pre> -->
<ng-template #template>
  <div class="modal-body text-center">
    <p>Do you want to remove this product from Cart?</p>
    <button type="button" class="btn btn-primary mr-1" (click)="confirm()">Yes</button>
    <button type="button" class="btn btn-danger" (click)="decline()">No</button>
  </div>
</ng-template>


<ng-template #templatee>
  <div class="modal-body text-center">
    <p>Are You Existing User?</p>
    <button type="button" class="btn btn-primary mr-1" (click)="confirmUser()">Yes</button>
    <button type="button" class="btn btn-danger" (click)="declineUser()">No</button>
  </div>
</ng-template>